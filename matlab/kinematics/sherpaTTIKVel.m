%sherpaTTFKVel.m
%author: wreid
%date: 20150122

function qDot = sherpaTTIKVel(uDot,q,kinematicConst)
%sherpaTTFKVel Sherpa_TT single leg forward velocity kinematics.

    [~,L2,L3,L4,L5,~,L7,~,zeta,~,~,~,~,~,~,~] = extractKinematicConstants(kinematicConst);

    alpha = q(1);
    beta = q(2);
    gamma = q(3);
    phi = 0;
    
    xDot = uDot(1);
    yDot = uDot(2);
    zDot = uDot(3);
    
    qDot = real([(conj(xDot)*(cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)*L5^2 - cos(beta)*sin(alpha)*sin(beta)*L3^2))/(L3^3*cos(beta)^2*sin(alpha)^2*sin(beta) - L5^3*cos(gamma + zeta)^2*sin(gamma + zeta)*sin(alpha)^2 + L2*L3^2*cos(beta)*sin(alpha)^2*sin(beta) - L3^2*L7*cos(beta)*sin(alpha)^2*sin(beta) - L3*L5^2*cos(gamma + zeta)^2*cos(alpha)^2*sin(beta) + L3^2*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta)^2 - L2*L5^2*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2 + L5^2*L7*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2 + L3^2*L4*cos(beta)*sin(alpha)^2*sin(beta)*cos(zeta) + L3*L5^2*cos(gamma + zeta)*sin(gamma + zeta)*cos(alpha)^2*cos(beta) - L3*L5^2*cos(gamma + zeta)*sin(gamma + zeta)*cos(beta)*sin(alpha)^2 - L3^2*L5*cos(gamma + zeta)*cos(alpha)^2*cos(beta)*sin(beta) - L4*L5^2*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2*cos(zeta) + L3^2*L5*cos(gamma + zeta)*cos(beta)*sin(alpha)^2*sin(beta) - L2*L3*L5*cos(gamma + zeta)*cos(alpha)^2*sin(beta) + L2*L3*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta) + L3*L5*L7*cos(gamma + zeta)*cos(alpha)^2*sin(beta) - L3*L5*L7*sin(gamma + zeta)*cos(alpha)^2*cos(beta) - L3*L4*L5*cos(gamma + zeta)*cos(alpha)^2*sin(beta)*cos(zeta) + L3*L4*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta)*cos(zeta)) - (conj(zDot)*(L5^2*sin(gamma + zeta)^2*cos(alpha)*sin(alpha) - L3^2*cos(alpha)*sin(alpha)*sin(beta)^2))/(L3^3*cos(beta)^2*sin(alpha)^2*sin(beta) - L5^3*cos(gamma + zeta)^2*sin(gamma + zeta)*sin(alpha)^2 + L2*L3^2*cos(beta)*sin(alpha)^2*sin(beta) - L3^2*L7*cos(beta)*sin(alpha)^2*sin(beta) - L3*L5^2*cos(gamma + zeta)^2*cos(alpha)^2*sin(beta) + L3^2*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta)^2 - L2*L5^2*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2 + L5^2*L7*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2 + L3^2*L4*cos(beta)*sin(alpha)^2*sin(beta)*cos(zeta) + L3*L5^2*cos(gamma + zeta)*sin(gamma + zeta)*cos(alpha)^2*cos(beta) - L3*L5^2*cos(gamma + zeta)*sin(gamma + zeta)*cos(beta)*sin(alpha)^2 - L3^2*L5*cos(gamma + zeta)*cos(alpha)^2*cos(beta)*sin(beta) - L4*L5^2*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2*cos(zeta) + L3^2*L5*cos(gamma + zeta)*cos(beta)*sin(alpha)^2*sin(beta) - L2*L3*L5*cos(gamma + zeta)*cos(alpha)^2*sin(beta) + L2*L3*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta) + L3*L5*L7*cos(gamma + zeta)*cos(alpha)^2*sin(beta) - L3*L5*L7*sin(gamma + zeta)*cos(alpha)^2*cos(beta) - L3*L4*L5*cos(gamma + zeta)*cos(alpha)^2*sin(beta)*cos(zeta) + L3*L4*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta)*cos(zeta)) - (conj(yDot)*(L3*L5*cos(gamma + zeta)*cos(alpha)*sin(beta) - L3*L5*sin(gamma + zeta)*cos(alpha)*cos(beta)))/(L3^3*cos(beta)^2*sin(alpha)^2*sin(beta) - L5^3*cos(gamma + zeta)^2*sin(gamma + zeta)*sin(alpha)^2 + L2*L3^2*cos(beta)*sin(alpha)^2*sin(beta) - L3^2*L7*cos(beta)*sin(alpha)^2*sin(beta) - L3*L5^2*cos(gamma + zeta)^2*cos(alpha)^2*sin(beta) + L3^2*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta)^2 - L2*L5^2*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2 + L5^2*L7*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2 + L3^2*L4*cos(beta)*sin(alpha)^2*sin(beta)*cos(zeta) + L3*L5^2*cos(gamma + zeta)*sin(gamma + zeta)*cos(alpha)^2*cos(beta) - L3*L5^2*cos(gamma + zeta)*sin(gamma + zeta)*cos(beta)*sin(alpha)^2 - L3^2*L5*cos(gamma + zeta)*cos(alpha)^2*cos(beta)*sin(beta) - L4*L5^2*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2*cos(zeta) + L3^2*L5*cos(gamma + zeta)*cos(beta)*sin(alpha)^2*sin(beta) - L2*L3*L5*cos(gamma + zeta)*cos(alpha)^2*sin(beta) + L2*L3*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta) + L3*L5*L7*cos(gamma + zeta)*cos(alpha)^2*sin(beta) - L3*L5*L7*sin(gamma + zeta)*cos(alpha)^2*cos(beta) - L3*L4*L5*cos(gamma + zeta)*cos(alpha)^2*sin(beta)*cos(zeta) + L3*L4*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta)*cos(zeta));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (conj(zDot)*(L5*sin(gamma + zeta)*cos(alpha)^2 + L3*sin(beta)*sin(alpha)^2))/(L5^2*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2 - L3^2*cos(beta)*sin(alpha)^2*sin(beta) + L3*L5*cos(gamma + zeta)*cos(alpha)^2*sin(beta) - L3*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta)) - (L5*cos(gamma + zeta)*cos(alpha)*conj(xDot))/(L5^2*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2 - L3^2*cos(beta)*sin(alpha)^2*sin(beta) + L3*L5*cos(gamma + zeta)*cos(alpha)^2*sin(beta) - L3*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta)) - (L5*cos(gamma + zeta)*sin(alpha)*conj(yDot))/(L5^2*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2 - L3^2*cos(beta)*sin(alpha)^2*sin(beta) + L3*L5*cos(gamma + zeta)*cos(alpha)^2*sin(beta) - L3*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (L3*cos(alpha)*cos(beta)*conj(xDot))/(L5^2*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2 - L3^2*cos(beta)*sin(alpha)^2*sin(beta) + L3*L5*cos(gamma + zeta)*cos(alpha)^2*sin(beta) - L3*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta)) - (conj(zDot)*(L3*sin(beta)*cos(alpha)^2 + L5*sin(gamma + zeta)*sin(alpha)^2))/(L5^2*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2 - L3^2*cos(beta)*sin(alpha)^2*sin(beta) + L3*L5*cos(gamma + zeta)*cos(alpha)^2*sin(beta) - L3*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta)) + (L3*cos(beta)*sin(alpha)*conj(yDot))/(L5^2*cos(gamma + zeta)*sin(gamma + zeta)*sin(alpha)^2 - L3^2*cos(beta)*sin(alpha)^2*sin(beta) + L3*L5*cos(gamma + zeta)*cos(alpha)^2*sin(beta) - L3*L5*sin(gamma + zeta)*cos(alpha)^2*cos(beta))]);
end