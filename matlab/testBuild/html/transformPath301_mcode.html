<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S68T55U570">path</span> = transformPath(<span class="var type1" id="S69T47U573">pathOld</span>,<span class="var type1" id="S70T6U574">NODE_SIZE</span>,<span class="var type1" id="S71T5U575">kinematicConst</span>,<span class="var type1" id="S72T4U576">dt</span>,<span class="var type1" id="S73T4U577">Dt</span>,<span class="var type1" id="S74T7U578">TP2B</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">    <span class="comment">%Take the pathOld array and combine the general nodes and intermediate</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">    <span class="comment">%states into a uniform path. The output path should be a npx6 array</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">    <span class="comment">%that contains the n general nodes and the p intermediate nodes between</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">    <span class="comment">%general nodes. Each row in the path matrix contains </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">    <span class="comment">%[t,x,y,z,xDot,yDot,zDot] state data.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">    <span class="mxinfo " id="T4:U8">[<span class="var type1" id="S75T4U582">pathH</span>,<span class="var type1" id="S76T4U583">pathW</span>] = size(<span class="var type1" id="S69T47U586">pathOld</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">    <span class="mxinfo " id="T55:U12"><span class="var type1" id="S68T55U589">path</span> = <span class="mxinfo " id="T55:U14">zeros(<span class="mxinfo " id="T4:U15"><span class="mxinfo " id="T4:U16">round(<span class="mxinfo " id="T4:U17"><span class="var type1" id="S73T4U596">Dt</span>/<span class="var type1" id="S72T4U597">dt</span></span>)</span>*<span class="var type1" id="S75T4U598">pathH</span></span>,<span class="mxinfo " id="T4:U21">7</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">    <span class="mxinfo " id="T4:U22"><span class="var type1" id="S80T4U602">count</span> = <span class="mxinfo " id="T4:U24">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">    <span class="mxinfo " id="T4:U25"><span class="var type1" id="S81T4U606">time</span> = <span class="mxinfo " id="T4:U27"><span class="mxinfo " id="T4:U28"><span class="mxinfo " id="T4:U29">round(<span class="mxinfo " id="T4:U30"><span class="var type1" id="S73T4U612">Dt</span>/<span class="var type1" id="S72T4U613">dt</span></span>)</span>*<span class="var type1" id="S75T4U614">pathH</span></span>*<span class="var type1" id="S72T4U615">dt</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S82T4U618">i</span> = <span class="mxinfo " id="T4:U36">1</span>:<span class="var type1" id="S75T4U621">pathH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S83T6U624">j</span> = <span class="var type1" id="S76T4U627">pathW</span>:<span class="mxinfo " id="T6:U40">-6</span>:<span class="mxinfo " id="T6:U41"><span class="var type1" id="S70T6U631">NODE_SIZE</span>+<span class="mxinfo " id="T6:U43">7</span></span>            </span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">            [<span class="mxinfo " id="T4:U44"><span class="var type1" id="S84T4U636">xP</span></span>,<span class="mxinfo " id="T4:U46"><span class="var type1" id="S85T4U637">yP</span></span>,<span class="mxinfo " id="T4:U48"><span class="var type1" id="S86T4U638">zP</span></span>] = <span class="fcn" id="F293N26:B640">sherpaTTFK</span>(<span class="mxinfo " id="T4:U50"><span class="var type1" id="S69T47U642">pathOld</span>(<span class="var type1" id="S82T4U643">i</span>,<span class="mxinfo " id="T6:U53"><span class="var type1" id="S83T6U645">j</span>-<span class="mxinfo " id="T6:U55">5</span></span>)</span>,<span class="mxinfo " id="T4:U56"><span class="var type1" id="S69T47U648">pathOld</span>(<span class="var type1" id="S82T4U649">i</span>,<span class="mxinfo " id="T6:U59"><span class="var type1" id="S83T6U651">j</span>-<span class="mxinfo " id="T6:U61">4</span></span>)</span>,<span class="mxinfo " id="T4:U62"><span class="var type1" id="S69T47U654">pathOld</span>(<span class="var type1" id="S82T4U655">i</span>,<span class="mxinfo " id="T6:U65"><span class="var type1" id="S83T6U657">j</span>-<span class="mxinfo " id="T6:U67">3</span></span>)</span>,<span class="var type1" id="S71T5U659">kinematicConst</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">            <span class="mxinfo " id="T9:U69"><span class="var type1" id="S88T9U662">uB</span> = <span class="mxinfo " id="T9:U71"><span class="mxinfo " id="T9:U72"><span class="mxinfo " id="T8:U73"><span class="var type1" id="S74T7U666">TP2B</span>(<span class="mxinfo " id="T44:U75"><span class="mxinfo " id="T4:U76">1</span>:<span class="mxinfo " id="T4:U77">3</span></span>,<span class="mxinfo " id="T44:U78"><span class="mxinfo " id="T4:U79">1</span>:<span class="mxinfo " id="T4:U80">3</span></span>)</span>*<span class="mxinfo " id="T9:U81">[<span class="var type1" id="S84T4U675">xP</span>;<span class="var type1" id="S85T4U677">yP</span>;<span class="var type1" id="S86T4U679">zP</span>]</span></span> + <span class="mxinfo " id="T9:U85"><span class="var type1" id="S74T7U681">TP2B</span>(<span class="mxinfo " id="T44:U87"><span class="mxinfo " id="T4:U88">1</span>:<span class="mxinfo " id="T4:U89">3</span></span>,<span class="mxinfo " id="T4:U90">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">            <span class="mxinfo " id="T9:U91"><span class="var type1" id="S89T9U688">uDot</span> = <span class="mxinfo " id="T9:U93"><span class="fcn" id="F294N27:B690">sherpaTTFKVel</span>(<span class="mxinfo " id="T9:U94"><span class="mxinfo " id="T44:U95">[<span class="mxinfo " id="T4:U96"><span class="var type1" id="S69T47U695">pathOld</span>(<span class="var type1" id="S82T4U696">i</span>,<span class="mxinfo " id="T6:U99"><span class="var type1" id="S83T6U698">j</span>-<span class="mxinfo " id="T6:U101">2</span></span>)</span> <span class="mxinfo " id="T4:U102"><span class="var type1" id="S69T47U701">pathOld</span>(<span class="var type1" id="S82T4U702">i</span>,<span class="mxinfo " id="T6:U105"><span class="var type1" id="S83T6U704">j</span>-<span class="mxinfo " id="T6:U107">1</span></span>)</span> <span class="mxinfo " id="T4:U108"><span class="var type1" id="S69T47U707">pathOld</span>(<span class="var type1" id="S82T4U708">i</span>,<span class="var type1" id="S83T6U709">j</span>)</span>]</span>'</span>,<span class="mxinfo " id="T9:U112"><span class="mxinfo " id="T44:U113">[<span class="mxinfo " id="T4:U114"><span class="var type1" id="S69T47U714">pathOld</span>(<span class="var type1" id="S82T4U715">i</span>,<span class="mxinfo " id="T6:U117"><span class="var type1" id="S83T6U717">j</span>-<span class="mxinfo " id="T6:U119">5</span></span>)</span> <span class="mxinfo " id="T4:U120"><span class="var type1" id="S69T47U720">pathOld</span>(<span class="var type1" id="S82T4U721">i</span>,<span class="mxinfo " id="T6:U123"><span class="var type1" id="S83T6U723">j</span>-<span class="mxinfo " id="T6:U125">4</span></span>)</span> <span class="mxinfo " id="T4:U126"><span class="var type1" id="S69T47U726">pathOld</span>(<span class="var type1" id="S82T4U727">i</span>,<span class="mxinfo " id="T6:U129"><span class="var type1" id="S83T6U729">j</span>-<span class="mxinfo " id="T6:U131">3</span></span>)</span>]</span>'</span>,<span class="var type1" id="S71T5U731">kinematicConst</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">            <span class="mxinfo " id="T9:U133"><span class="var type1" id="S91T9U734">uBDot</span> = <span class="mxinfo " id="T9:U135"><span class="mxinfo " id="T8:U136"><span class="var type1" id="S74T7U737">TP2B</span>(<span class="mxinfo " id="T44:U138"><span class="mxinfo " id="T4:U139">1</span>:<span class="mxinfo " id="T4:U140">3</span></span>,<span class="mxinfo " id="T44:U141"><span class="mxinfo " id="T4:U142">1</span>:<span class="mxinfo " id="T4:U143">3</span></span>)</span>*<span class="var type1" id="S89T9U744">uDot</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">            <span class="mxinfo " id="T69:U145"><span class="mxinfo " id="T69:U146"><span class="var type1" id="S68T55U748">path</span>(<span class="var type1" id="S80T4U749">count</span>,:)</span> = <span class="mxinfo " id="T69:U149">[<span class="var type1" id="S81T4U753">time</span> <span class="mxinfo " id="T44:U151"><span class="var type1" id="S88T9U755">uB</span>'</span> <span class="mxinfo " id="T44:U153"><span class="var type1" id="S91T9U757">uBDot</span>'</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">            <span class="mxinfo " id="T4:U155"><span class="var type1" id="S81T4U760">time</span> = <span class="mxinfo " id="T4:U157"><span class="var type1" id="S81T4U762">time</span> - <span class="var type1" id="S72T4U763">dt</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">            <span class="mxinfo " id="T4:U160"><span class="var type1" id="S80T4U766">count</span> = <span class="mxinfo " id="T4:U162"><span class="var type1" id="S80T4U768">count</span> + <span class="mxinfo " id="T4:U164">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">    <span class="mxinfo " id="T55:U165"><span class="var type1" id="S68T55U772">path</span> = <span class="mxinfo " id="T55:U167">flipud(<span class="mxinfo " id="T55:U168"><span class="var type1" id="S68T55U776">path</span>(:,<span class="mxinfo " id="T69:U170"><span class="mxinfo " id="T4:U171">1</span>:<span class="mxinfo " id="T4:U172">end</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
