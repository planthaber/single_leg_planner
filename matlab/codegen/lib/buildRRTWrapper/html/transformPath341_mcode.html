<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S68T60U579">path</span> = transformPath(<span class="var type1" id="S69T47U582">pathOld</span>,<span class="var type1" id="S70T6U583">NODE_SIZE</span>,<span class="var type1" id="S71T5U584">kinematicConst</span>,<span class="var type1" id="S72T4U585">dt</span>,<span class="var type1" id="S73T4U586">Dt</span>,<span class="var type1" id="S74T7U587">TP2B</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">    <span class="comment">%Take the pathOld array and combine the general nodes and intermediate</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">    <span class="comment">%states into a uniform path. The output path should be a npx6 array</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">    <span class="comment">%that contains the n general nodes and the p intermediate nodes between</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">    <span class="comment">%general nodes. Each row in the path matrix contains </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">    <span class="comment">%[t,x,y,z,xDot,yDot,zDot] state data.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">    <span class="mxinfo " id="T4:U8">[<span class="var type1" id="S75T4U591">pathH</span>,<span class="var type1" id="S76T4U592">pathW</span>] = size(<span class="var type1" id="S69T47U595">pathOld</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">    <span class="mxinfo " id="T60:U12"><span class="var type1" id="S68T60U598">path</span> = <span class="mxinfo " id="T60:U14">zeros(<span class="mxinfo " id="T4:U15"><span class="mxinfo " id="T4:U16">round(<span class="mxinfo " id="T4:U17"><span class="var type1" id="S73T4U605">Dt</span>/<span class="var type1" id="S72T4U606">dt</span></span>)</span>*<span class="var type1" id="S75T4U607">pathH</span></span>,<span class="mxinfo " id="T4:U21">7</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">    <span class="mxinfo " id="T4:U22"><span class="var type1" id="S80T4U611">count</span> = <span class="mxinfo " id="T4:U24">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">    <span class="mxinfo " id="T4:U25"><span class="var type1" id="S81T4U615">time</span> = <span class="mxinfo " id="T4:U27"><span class="mxinfo " id="T4:U28"><span class="mxinfo " id="T4:U29">round(<span class="mxinfo " id="T4:U30"><span class="var type1" id="S73T4U621">Dt</span>/<span class="var type1" id="S72T4U622">dt</span></span>)</span>*<span class="var type1" id="S75T4U623">pathH</span></span>*<span class="var type1" id="S72T4U624">dt</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S82T4U627">i</span> = <span class="mxinfo " id="T4:U36">1</span>:<span class="var type1" id="S75T4U630">pathH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S83T6U633">j</span> = <span class="var type1" id="S76T4U636">pathW</span>:<span class="mxinfo " id="T6:U40">-6</span>:<span class="mxinfo " id="T6:U41"><span class="var type1" id="S70T6U640">NODE_SIZE</span>+<span class="mxinfo " id="T6:U43">7</span></span>            </span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">            [<span class="mxinfo " id="T4:U44"><span class="var type1" id="S84T4U645">xP</span></span>,<span class="mxinfo " id="T4:U46"><span class="var type1" id="S85T4U646">yP</span></span>,<span class="mxinfo " id="T4:U48"><span class="var type1" id="S86T4U647">zP</span></span>] = <span class="fcn" id="F334N22:B649">sherpaTTFK</span>(<span class="mxinfo " id="T4:U50"><span class="var type1" id="S69T47U651">pathOld</span>(<span class="var type1" id="S82T4U652">i</span>,<span class="mxinfo " id="T6:U53"><span class="var type1" id="S83T6U654">j</span>-<span class="mxinfo " id="T6:U55">5</span></span>)</span>,<span class="mxinfo " id="T4:U56"><span class="var type1" id="S69T47U657">pathOld</span>(<span class="var type1" id="S82T4U658">i</span>,<span class="mxinfo " id="T6:U59"><span class="var type1" id="S83T6U660">j</span>-<span class="mxinfo " id="T6:U61">4</span></span>)</span>,<span class="mxinfo " id="T4:U62"><span class="var type1" id="S69T47U663">pathOld</span>(<span class="var type1" id="S82T4U664">i</span>,<span class="mxinfo " id="T6:U65"><span class="var type1" id="S83T6U666">j</span>-<span class="mxinfo " id="T6:U67">3</span></span>)</span>,<span class="var type1" id="S71T5U668">kinematicConst</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">            <span class="mxinfo " id="T9:U69"><span class="var type1" id="S88T9U671">uB</span> = <span class="mxinfo " id="T9:U71"><span class="mxinfo " id="T9:U72"><span class="mxinfo " id="T8:U73"><span class="var type1" id="S74T7U675">TP2B</span>(<span class="mxinfo " id="T44:U75"><span class="mxinfo " id="T4:U76">1</span>:<span class="mxinfo " id="T4:U77">3</span></span>,<span class="mxinfo " id="T44:U78"><span class="mxinfo " id="T4:U79">1</span>:<span class="mxinfo " id="T4:U80">3</span></span>)</span>*<span class="mxinfo " id="T9:U81">[<span class="var type1" id="S84T4U684">xP</span>;<span class="var type1" id="S85T4U686">yP</span>;<span class="var type1" id="S86T4U688">zP</span>]</span></span> + <span class="mxinfo " id="T9:U85"><span class="var type1" id="S74T7U690">TP2B</span>(<span class="mxinfo " id="T44:U87"><span class="mxinfo " id="T4:U88">1</span>:<span class="mxinfo " id="T4:U89">3</span></span>,<span class="mxinfo " id="T4:U90">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">            <span class="mxinfo " id="T9:U91"><span class="var type1" id="S89T9U697">uDot</span> = <span class="mxinfo " id="T9:U93"><span class="fcn" id="F311N23:B699">sherpaTTFKVel</span>(<span class="mxinfo " id="T9:U94"><span class="mxinfo " id="T44:U95">[<span class="mxinfo " id="T4:U96"><span class="var type1" id="S69T47U704">pathOld</span>(<span class="var type1" id="S82T4U705">i</span>,<span class="mxinfo " id="T6:U99"><span class="var type1" id="S83T6U707">j</span>-<span class="mxinfo " id="T6:U101">2</span></span>)</span> <span class="mxinfo " id="T4:U102"><span class="var type1" id="S69T47U710">pathOld</span>(<span class="var type1" id="S82T4U711">i</span>,<span class="mxinfo " id="T6:U105"><span class="var type1" id="S83T6U713">j</span>-<span class="mxinfo " id="T6:U107">1</span></span>)</span> <span class="mxinfo " id="T4:U108"><span class="var type1" id="S69T47U716">pathOld</span>(<span class="var type1" id="S82T4U717">i</span>,<span class="var type1" id="S83T6U718">j</span>)</span>]</span>'</span>,<span class="mxinfo " id="T9:U112"><span class="mxinfo " id="T44:U113">[<span class="mxinfo " id="T4:U114"><span class="var type1" id="S69T47U723">pathOld</span>(<span class="var type1" id="S82T4U724">i</span>,<span class="mxinfo " id="T6:U117"><span class="var type1" id="S83T6U726">j</span>-<span class="mxinfo " id="T6:U119">5</span></span>)</span> <span class="mxinfo " id="T4:U120"><span class="var type1" id="S69T47U729">pathOld</span>(<span class="var type1" id="S82T4U730">i</span>,<span class="mxinfo " id="T6:U123"><span class="var type1" id="S83T6U732">j</span>-<span class="mxinfo " id="T6:U125">4</span></span>)</span> <span class="mxinfo " id="T4:U126"><span class="var type1" id="S69T47U735">pathOld</span>(<span class="var type1" id="S82T4U736">i</span>,<span class="mxinfo " id="T6:U129"><span class="var type1" id="S83T6U738">j</span>-<span class="mxinfo " id="T6:U131">3</span></span>)</span>]</span>'</span>,<span class="var type1" id="S71T5U740">kinematicConst</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">            <span class="mxinfo " id="T9:U133"><span class="var type1" id="S91T9U743">uBDot</span> = <span class="mxinfo " id="T9:U135"><span class="mxinfo " id="T8:U136"><span class="var type1" id="S74T7U746">TP2B</span>(<span class="mxinfo " id="T44:U138"><span class="mxinfo " id="T4:U139">1</span>:<span class="mxinfo " id="T4:U140">3</span></span>,<span class="mxinfo " id="T44:U141"><span class="mxinfo " id="T4:U142">1</span>:<span class="mxinfo " id="T4:U143">3</span></span>)</span>*<span class="var type1" id="S89T9U753">uDot</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">            <span class="mxinfo " id="T74:U145"><span class="mxinfo " id="T74:U146"><span class="var type1" id="S68T60U757">path</span>(<span class="var type1" id="S80T4U758">count</span>,:)</span> = <span class="mxinfo " id="T74:U149">[<span class="var type1" id="S81T4U762">time</span> <span class="mxinfo " id="T44:U151"><span class="var type1" id="S88T9U764">uB</span>'</span> <span class="mxinfo " id="T44:U153"><span class="var type1" id="S91T9U766">uBDot</span>'</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">            <span class="mxinfo " id="T4:U155"><span class="var type1" id="S81T4U769">time</span> = <span class="mxinfo " id="T4:U157"><span class="var type1" id="S81T4U771">time</span> - <span class="var type1" id="S72T4U772">dt</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">            <span class="mxinfo " id="T4:U160"><span class="var type1" id="S80T4U775">count</span> = <span class="mxinfo " id="T4:U162"><span class="var type1" id="S80T4U777">count</span> + <span class="mxinfo " id="T4:U164">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">    <span class="mxinfo " id="T60:U165"><span class="var type1" id="S68T60U781">path</span> = <span class="mxinfo " id="T60:U167">flipud(<span class="mxinfo " id="T60:U168"><span class="var type1" id="S68T60U785">path</span>(:,<span class="mxinfo " id="T74:U170"><span class="mxinfo " id="T4:U171">1</span>:<span class="mxinfo " id="T4:U172">end</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
