<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S68T55U589">pathC</span>,<span class="var type1" id="S69T55U590">pathJ</span>] = transformPath(<span class="var type1" id="S70T47U593">pathOld</span>,<span class="var type1" id="S71T6U594">NODE_SIZE</span>,<span class="var type1" id="S72T5U595">kinematicConst</span>,<span class="var type1" id="S73T4U596">dt</span>,<span class="var type1" id="S74T4U597">Dt</span>,<span class="var type1" id="S75T7U598">TP2B</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">    <span class="comment">%Take the pathOld array and combine the general nodes and intermediate</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">    <span class="comment">%states into a uniform path. The output path should be a npx6 array</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">    <span class="comment">%that contains the n general nodes and the p intermediate nodes between</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">    <span class="comment">%general nodes. Each row in the path matrix contains </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">    <span class="comment">%[t,x,y,z,xDot,yDot,zDot] state data.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">    <span class="mxinfo " id="T4:U9">[<span class="var type1" id="S76T4U602">pathH</span>,<span class="var type1" id="S77T4U603">pathW</span>] = size(<span class="var type1" id="S70T47U606">pathOld</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">    <span class="mxinfo " id="T55:U13"><span class="var type1" id="S68T55U609">pathC</span> = <span class="mxinfo " id="T55:U15">zeros(<span class="mxinfo " id="T4:U16"><span class="mxinfo " id="T4:U17">round(<span class="mxinfo " id="T4:U18"><span class="var type1" id="S74T4U616">Dt</span>/<span class="var type1" id="S73T4U617">dt</span></span>)</span>*<span class="var type1" id="S76T4U618">pathH</span></span>,<span class="mxinfo " id="T4:U22">7</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">    <span class="mxinfo " id="T55:U23"><span class="var type1" id="S69T55U622">pathJ</span> = <span class="mxinfo " id="T55:U25">zeros(<span class="mxinfo " id="T4:U26"><span class="mxinfo " id="T4:U27">round(<span class="mxinfo " id="T4:U28"><span class="var type1" id="S74T4U629">Dt</span>/<span class="var type1" id="S73T4U630">dt</span></span>)</span>*<span class="var type1" id="S76T4U631">pathH</span></span>,<span class="mxinfo " id="T4:U32">7</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">    <span class="mxinfo " id="T4:U33"><span class="var type1" id="S81T4U635">count</span> = <span class="mxinfo " id="T4:U35">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">    <span class="mxinfo " id="T4:U36"><span class="var type1" id="S82T4U639">time</span> = <span class="mxinfo " id="T4:U38"><span class="mxinfo " id="T4:U39"><span class="mxinfo " id="T4:U40">round(<span class="mxinfo " id="T4:U41"><span class="var type1" id="S74T4U645">Dt</span>/<span class="var type1" id="S73T4U646">dt</span></span>)</span>*<span class="var type1" id="S76T4U647">pathH</span></span>*<span class="var type1" id="S73T4U648">dt</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S83T4U651">i</span> = <span class="mxinfo " id="T4:U47">1</span>:<span class="var type1" id="S76T4U654">pathH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S84T6U657">j</span> = <span class="var type1" id="S77T4U660">pathW</span>:<span class="mxinfo " id="T6:U51">-6</span>:<span class="mxinfo " id="T6:U52"><span class="var type1" id="S71T6U664">NODE_SIZE</span>+<span class="mxinfo " id="T6:U54">7</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">            [<span class="mxinfo " id="T4:U55"><span class="var type1" id="S85T4U669">xP</span></span>,<span class="mxinfo " id="T4:U57"><span class="var type1" id="S86T4U670">yP</span></span>,<span class="mxinfo " id="T4:U59"><span class="var type1" id="S87T4U671">zP</span></span>] = <span class="fcn" id="F293N26:B673">sherpaTTFK</span>(<span class="mxinfo " id="T4:U61"><span class="var type1" id="S70T47U675">pathOld</span>(<span class="var type1" id="S83T4U676">i</span>,<span class="mxinfo " id="T6:U64"><span class="var type1" id="S84T6U678">j</span>-<span class="mxinfo " id="T6:U66">5</span></span>)</span>,<span class="mxinfo " id="T4:U67"><span class="var type1" id="S70T47U681">pathOld</span>(<span class="var type1" id="S83T4U682">i</span>,<span class="mxinfo " id="T6:U70"><span class="var type1" id="S84T6U684">j</span>-<span class="mxinfo " id="T6:U72">4</span></span>)</span>,<span class="mxinfo " id="T4:U73"><span class="var type1" id="S70T47U687">pathOld</span>(<span class="var type1" id="S83T4U688">i</span>,<span class="mxinfo " id="T6:U76"><span class="var type1" id="S84T6U690">j</span>-<span class="mxinfo " id="T6:U78">3</span></span>)</span>,<span class="var type1" id="S72T5U692">kinematicConst</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">            <span class="mxinfo " id="T9:U80"><span class="var type1" id="S89T9U695">uB</span> = <span class="mxinfo " id="T9:U82"><span class="mxinfo " id="T9:U83"><span class="mxinfo " id="T8:U84"><span class="var type1" id="S75T7U699">TP2B</span>(<span class="mxinfo " id="T44:U86"><span class="mxinfo " id="T4:U87">1</span>:<span class="mxinfo " id="T4:U88">3</span></span>,<span class="mxinfo " id="T44:U89"><span class="mxinfo " id="T4:U90">1</span>:<span class="mxinfo " id="T4:U91">3</span></span>)</span>*<span class="mxinfo " id="T9:U92">[<span class="var type1" id="S85T4U708">xP</span>;<span class="var type1" id="S86T4U710">yP</span>;<span class="var type1" id="S87T4U712">zP</span>]</span></span> + <span class="mxinfo " id="T9:U96"><span class="var type1" id="S75T7U714">TP2B</span>(<span class="mxinfo " id="T44:U98"><span class="mxinfo " id="T4:U99">1</span>:<span class="mxinfo " id="T4:U100">3</span></span>,<span class="mxinfo " id="T4:U101">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">            <span class="mxinfo " id="T9:U102"><span class="var type1" id="S90T9U721">uDot</span> = <span class="mxinfo " id="T9:U104"><span class="fcn" id="F294N27:B723">sherpaTTFKVel</span>(<span class="mxinfo " id="T9:U105"><span class="mxinfo " id="T44:U106">[<span class="mxinfo " id="T4:U107"><span class="var type1" id="S70T47U728">pathOld</span>(<span class="var type1" id="S83T4U729">i</span>,<span class="mxinfo " id="T6:U110"><span class="var type1" id="S84T6U731">j</span>-<span class="mxinfo " id="T6:U112">2</span></span>)</span> <span class="mxinfo " id="T4:U113"><span class="var type1" id="S70T47U734">pathOld</span>(<span class="var type1" id="S83T4U735">i</span>,<span class="mxinfo " id="T6:U116"><span class="var type1" id="S84T6U737">j</span>-<span class="mxinfo " id="T6:U118">1</span></span>)</span> <span class="mxinfo " id="T4:U119"><span class="var type1" id="S70T47U740">pathOld</span>(<span class="var type1" id="S83T4U741">i</span>,<span class="var type1" id="S84T6U742">j</span>)</span>]</span>'</span>,<span class="mxinfo " id="T9:U123"><span class="mxinfo " id="T44:U124">[<span class="mxinfo " id="T4:U125"><span class="var type1" id="S70T47U747">pathOld</span>(<span class="var type1" id="S83T4U748">i</span>,<span class="mxinfo " id="T6:U128"><span class="var type1" id="S84T6U750">j</span>-<span class="mxinfo " id="T6:U130">5</span></span>)</span> <span class="mxinfo " id="T4:U131"><span class="var type1" id="S70T47U753">pathOld</span>(<span class="var type1" id="S83T4U754">i</span>,<span class="mxinfo " id="T6:U134"><span class="var type1" id="S84T6U756">j</span>-<span class="mxinfo " id="T6:U136">4</span></span>)</span> <span class="mxinfo " id="T4:U137"><span class="var type1" id="S70T47U759">pathOld</span>(<span class="var type1" id="S83T4U760">i</span>,<span class="mxinfo " id="T6:U140"><span class="var type1" id="S84T6U762">j</span>-<span class="mxinfo " id="T6:U142">3</span></span>)</span>]</span>'</span>,<span class="var type1" id="S72T5U764">kinematicConst</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">            <span class="mxinfo " id="T9:U144"><span class="var type1" id="S92T9U767">uBDot</span> = <span class="mxinfo " id="T9:U146"><span class="mxinfo " id="T8:U147"><span class="var type1" id="S75T7U770">TP2B</span>(<span class="mxinfo " id="T44:U149"><span class="mxinfo " id="T4:U150">1</span>:<span class="mxinfo " id="T4:U151">3</span></span>,<span class="mxinfo " id="T44:U152"><span class="mxinfo " id="T4:U153">1</span>:<span class="mxinfo " id="T4:U154">3</span></span>)</span>*<span class="var type1" id="S90T9U777">uDot</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">            <span class="mxinfo " id="T69:U156"><span class="mxinfo " id="T69:U157"><span class="var type1" id="S68T55U781">pathC</span>(<span class="var type1" id="S81T4U782">count</span>,:)</span> = <span class="mxinfo " id="T69:U160">[<span class="var type1" id="S82T4U786">time</span> <span class="mxinfo " id="T44:U162"><span class="var type1" id="S89T9U788">uB</span>'</span> <span class="mxinfo " id="T44:U164"><span class="var type1" id="S92T9U790">uBDot</span>'</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">            <span class="mxinfo " id="T69:U166"><span class="mxinfo " id="T69:U167"><span class="var type1" id="S69T55U794">pathJ</span>(<span class="var type1" id="S81T4U795">count</span>,:)</span> = <span class="mxinfo " id="T69:U170">[<span class="var type1" id="S82T4U799">time</span> <span class="mxinfo " id="T18:U172"><span class="var type1" id="S70T47U801">pathOld</span>(<span class="var type1" id="S83T4U802">i</span>,<span class="mxinfo " id="T76:U175"><span class="mxinfo " id="T6:U176"><span class="var type1" id="S84T6U805">j</span>-5</span>:<span class="var type1" id="S84T6U807">j</span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">            <span class="mxinfo " id="T4:U179"><span class="var type1" id="S82T4U810">time</span> = <span class="mxinfo " id="T4:U181"><span class="var type1" id="S82T4U812">time</span> - <span class="var type1" id="S73T4U813">dt</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">            <span class="mxinfo " id="T4:U184"><span class="var type1" id="S81T4U816">count</span> = <span class="mxinfo " id="T4:U186"><span class="var type1" id="S81T4U818">count</span> + <span class="mxinfo " id="T4:U188">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">    <span class="mxinfo " id="T55:U189"><span class="var type1" id="S68T55U822">pathC</span> = <span class="mxinfo " id="T55:U191">flipud(<span class="mxinfo " id="T55:U192"><span class="var type1" id="S68T55U826">pathC</span>(:,<span class="mxinfo " id="T69:U194"><span class="mxinfo " id="T4:U195">1</span>:<span class="mxinfo " id="T4:U196">end</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">    <span class="mxinfo " id="T55:U197"><span class="var type1" id="S69T55U834">pathJ</span> = <span class="mxinfo " id="T55:U199">flipud(<span class="mxinfo " id="T55:U200"><span class="var type1" id="S69T55U838">pathJ</span>(:,<span class="mxinfo " id="T69:U202"><span class="mxinfo " id="T4:U203">1</span>:<span class="mxinfo " id="T4:U204">end</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
