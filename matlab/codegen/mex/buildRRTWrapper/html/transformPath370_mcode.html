<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S68T63U482">path</span> = transformPath(<span class="var type1" id="S69T62U485">pathJ</span>,<span class="var type1" id="S70T6U486">kC</span>,<span class="var type1" id="S71T4U487">dt</span>,<span class="var type1" id="S72T4U488">Dt</span>,<span class="var type1" id="S73T10U489">TP2B</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">    <span class="comment">%Take the pathOld array and combine the general nodes and intermediate</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">    <span class="comment">%states into a uniform path. The output path should be a npx6 array</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">    <span class="comment">%that contains the n general nodes and the p intermediate nodes between</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">    <span class="comment">%general nodes. Each row in the path matrix contains </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">    <span class="comment">%[t,x,y,z,xDot,yDot,zDot] state data.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line"><span class="comment">%     [pathH,pathW] = size(pathOld);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line"><span class="comment">%     pathC = zeros(round(Dt/dt)*pathH,7);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"><span class="comment">%     pathJ = zeros(round(Dt/dt)*pathH,9);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line"><span class="comment">%     count = 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line"><span class="comment">%     time = round(Dt/dt)*pathH*dt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line"><span class="comment">%     for i = 1:pathH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line"><span class="comment">%         for j = pathW:-6:NODE_SIZE+7</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line"><span class="comment">%             uP = sherpaTTFK(pathOld(i,j-5:j-3),kC);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line"><span class="comment">%             uB = TP2B(1:3,1:3)*uP' + TP2B(1:3,4);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line"><span class="comment">%             uDot = sherpaTTFKVel(pathOld(i,j-2:j)',pathOld(i,j-5:j-3)',kC);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line"><span class="comment">%             uBDot = TP2B(1:3,1:3)*uDot;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line"><span class="comment">%             pathC(count,:) = [time uB' uBDot'];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line"><span class="comment">%             pathJ(count,:) = [time pathOld(i,j-5:j) pathOld(i,10) pathOld(i,11)];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line"><span class="comment">%             time = time - dt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line"><span class="comment">%             count = count + 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line"><span class="comment">%         end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line"><span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line"><span class="comment">%     pathC = flipud(pathC(:,1:end));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line"><span class="comment">%     pathJ = flipud(pathJ(:,1:end));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">    <span class="mxinfo " id="T4:U7">[<span class="var type1" id="S74T4U493">pathH</span>,<span class="var type1" id="S75T4U494">pathW</span>] = size(<span class="var type1" id="S69T62U497">pathJ</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">    <span class="mxinfo " id="T63:U11"><span class="var type1" id="S68T63U500">path</span> = <span class="mxinfo " id="T63:U13">zeros(<span class="var type1" id="S74T4U503">pathH</span>,<span class="mxinfo " id="T4:U15"><span class="var type1" id="S75T4U505">pathW</span>+6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S78T4U509">i</span> = <span class="mxinfo " id="T4:U18">1</span>:<span class="var type1" id="S74T4U512">pathH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">        <span class="mxinfo " id="T8:U20"><span class="var type1" id="S79T8U515">uP</span> = <span class="mxinfo " id="T8:U22"><span class="fcn" id="F14N31:B517">sherpaTTFK</span>(<span class="mxinfo " id="T8:U23"><span class="var type1" id="S69T62U519">pathJ</span>(<span class="var type1" id="S78T4U520">i</span>,<span class="mxinfo " id="T8:U26"><span class="mxinfo " id="T4:U27">2</span>:<span class="mxinfo " id="T4:U28">4</span></span>)</span>,<span class="var type1" id="S70T6U524">kC</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">        <span class="mxinfo " id="T12:U30"><span class="var type1" id="S81T12U527">uB</span> = <span class="mxinfo " id="T12:U32"><span class="mxinfo " id="T12:U33"><span class="mxinfo " id="T11:U34"><span class="var type1" id="S73T10U531">TP2B</span>(<span class="mxinfo " id="T8:U36"><span class="mxinfo " id="T4:U37">1</span>:<span class="mxinfo " id="T4:U38">3</span></span>,<span class="mxinfo " id="T8:U39"><span class="mxinfo " id="T4:U40">1</span>:<span class="mxinfo " id="T4:U41">3</span></span>)</span>*<span class="mxinfo " id="T12:U42"><span class="var type1" id="S79T8U539">uP</span>'</span></span> + <span class="mxinfo " id="T12:U44"><span class="var type1" id="S73T10U541">TP2B</span>(<span class="mxinfo " id="T8:U46"><span class="mxinfo " id="T4:U47">1</span>:<span class="mxinfo " id="T4:U48">3</span></span>,<span class="mxinfo " id="T4:U49">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">        <span class="mxinfo " id="T12:U50"><span class="var type1" id="S82T12U548">uPDot</span> = <span class="mxinfo " id="T12:U52"><span class="fcn" id="F369N32:B550">sherpaTTFKVel</span>(<span class="mxinfo " id="T8:U53"><span class="var type1" id="S69T62U552">pathJ</span>(<span class="var type1" id="S78T4U553">i</span>,<span class="mxinfo " id="T8:U56"><span class="mxinfo " id="T4:U57">5</span>:<span class="mxinfo " id="T4:U58">7</span></span>)</span>,<span class="mxinfo " id="T8:U59"><span class="var type1" id="S69T62U558">pathJ</span>(<span class="var type1" id="S78T4U559">i</span>,<span class="mxinfo " id="T8:U62"><span class="mxinfo " id="T4:U63">2</span>:<span class="mxinfo " id="T4:U64">4</span></span>)</span>,<span class="var type1" id="S70T6U563">kC</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">        <span class="mxinfo " id="T12:U66"><span class="var type1" id="S84T12U566">uBDot</span> = <span class="mxinfo " id="T12:U68"><span class="mxinfo " id="T11:U69"><span class="var type1" id="S73T10U569">TP2B</span>(<span class="mxinfo " id="T8:U71"><span class="mxinfo " id="T4:U72">1</span>:<span class="mxinfo " id="T4:U73">3</span></span>,<span class="mxinfo " id="T8:U74"><span class="mxinfo " id="T4:U75">1</span>:<span class="mxinfo " id="T4:U76">3</span></span>)</span>*<span class="var type1" id="S82T12U576">uPDot</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">        <span class="mxinfo " id="T74:U78"><span class="mxinfo " id="T74:U79"><span class="var type1" id="S68T63U580">path</span>(<span class="var type1" id="S78T4U581">i</span>,:)</span> = <span class="mxinfo " id="T74:U82">[<span class="mxinfo " id="T73:U83"><span class="var type1" id="S69T62U586">pathJ</span>(<span class="var type1" id="S78T4U587">i</span>,:)</span> <span class="mxinfo " id="T8:U86"><span class="var type1" id="S81T12U590">uB</span>'</span> <span class="mxinfo " id="T8:U88"><span class="var type1" id="S84T12U592">uBDot</span>'</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"></span></span>
</pre>
